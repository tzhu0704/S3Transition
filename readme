创建库
spark-shell \
--packages org.apache.iceberg:iceberg-spark-runtime-3.5_2.12:1.6.1,software.amazon.s3tables:s3-tables-catalog-for-iceberg-runtime:0.1.3 \
--conf spark.sql.catalog.s3tablesbucket=org.apache.iceberg.spark.SparkCatalog \
--conf spark.sql.catalog.s3tablesbucket.catalog-impl=software.amazon.s3tables.iceberg.S3TablesCatalog \
--conf spark.sql.catalog.s3tablesbucket.warehouse=arn:aws:s3tables:us-east-1:509399592849:bucket/mys3tablebucket0 \
--conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions

创建namespace
spark.sql(" CREATE NAMESPACE IF NOT EXISTS s3tablesbucket.mys3tabledb0")

创建表
spark.sql(" CREATE TABLE IF NOT EXISTS s3tablesbucket.mys3tabledb0.`mys3table2` ( id INT, name STRING, value INT USING iceberg ) ")

CREATE TABLE mytable (
id INT,
name CHAR(20) NOT NULL,
gender CHAR(10) NOT NULL
) ENGINE=InnoDB;

arn:aws:iam::509399592849:user/*
aws vpc modify-vpc-endpoint-service-permissions \
    --service-id vpce-svc-052879a77fc7f326c\
    --add-allowed-principals arn:aws:iam::*:user/* firehose.amazonaws.com

插入数据
spark.sql(" insert inot s3tablesbucket.mys3tabledb0.`mys3table2` values ( 33,'323','fsf') ( 34,'1323','fsf1') ")


